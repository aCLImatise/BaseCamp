version 1.0

task MageckPathway {
  input {
    String? gene_ranking
    String? gmt_file
    String? output_prefix
    String? method
    Boolean? single_ranking
    String? sort_criteria
    Boolean? keep_tmp
    String? ranking_column
    String? ranking_column_two
    File? pathway_alpha
    String? permutation
  }
  command <<<
    mageck pathway \
      ~{if defined(gene_ranking) then ("--gene-ranking " +  '"' + gene_ranking + '"') else ""} \
      ~{if defined(gmt_file) then ("--gmt-file " +  '"' + gmt_file + '"') else ""} \
      ~{if defined(output_prefix) then ("--output-prefix " +  '"' + output_prefix + '"') else ""} \
      ~{if defined(method) then ("--method " +  '"' + method + '"') else ""} \
      ~{true="--single-ranking" false="" single_ranking} \
      ~{if defined(sort_criteria) then ("--sort-criteria " +  '"' + sort_criteria + '"') else ""} \
      ~{true="--keep-tmp" false="" keep_tmp} \
      ~{if defined(ranking_column) then ("--ranking-column " +  '"' + ranking_column + '"') else ""} \
      ~{if defined(ranking_column_two) then ("--ranking-column-2 " +  '"' + ranking_column_two + '"') else ""} \
      ~{if defined(pathway_alpha) then ("--pathway-alpha " +  '"' + pathway_alpha + '"') else ""} \
      ~{if defined(permutation) then ("--permutation " +  '"' + permutation + '"') else ""}
  >>>
  parameter_meta {
    gene_ranking: "The gene summary file (containing both positive and negative selection tests) generated by the gene test step. Pathway enrichment will be performed in both directions."
    gmt_file: "The pathway file in GMT format."
    output_prefix: "The prefix of the output file(s). Default sample1."
    method: "Method for testing pathway enrichment, including gsea (Gene Set Enrichment Analysis) or rra. Default gsea."
    single_ranking: "The provided file is a (single) gene ranking file, either positive or negative selection. Only one enrichment comparison will be performed."
    sort_criteria: "Sorting criteria, either by negative selection (neg) or positive selection (pos). Default negative selection."
    keep_tmp: "Keep intermediate files."
    ranking_column: "Column number or label in gene summary file for gene ranking; can be either an integer of column number, or a string of column label. Default \"2\" (the 3rd column), the column of the negative selection RRA score in gene_summary file."
    ranking_column_two: "Column number or label in gene summary file for gene ranking; can be either an integer of column number, or a string of column label. This option is used to determine the column for positive selections and is disabled if --single-ranking is specified. Default \"8\" (the 9th column), the column of positive selection RRA score in gene_summary file."
    pathway_alpha: "The default alpha value for RRA pathway enrichment. Default 0.25."
    permutation: "The perumtation for gsea. Default 1000."
  }
}