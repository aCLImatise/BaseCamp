from datetime import datetime
from typing import List, Optional, Dict, Any

from janis_core import *
from janis_core.types.common_data_types import Boolean, Directory

Shortstack_V0_1_0 = CommandToolBuilder(tool="ShortStack", base_command=["ShortStack"], inputs=[ToolInput(tag="in_genome_file", input_type=Boolean(optional=True), prefix="--genomefile", doc=InputDocumentation(doc="[string] : path to reference genome in .fasta or .fa format. Required for any run.")), ToolInput(tag="in_outdir", input_type=Directory(optional=True), prefix="--outdir", doc=InputDocumentation(doc="[string] : name of output directory to be created for results. Defaults to 'ShortStack_[time]',\nwhere [time] is the current UNIX time according to the system. If the outdir already exists, ShortStack\nwill exit with an error message.")), ToolInput(tag="in_readfile", input_type=Boolean(optional=True), prefix="--readfile", doc=InputDocumentation(doc="[string] : path to readfile(s) to be aligned. valid formats: .fasta, .fa, .fasta.gz,\n.fa.gz, .fastq, .fq, .fastq.gz, .fq.gz, .csfasta, .csfasta.gz. Multiple files, can be specified as\nseparate arguments to --readfile ... e.g. --readfile file1.fastq file2.fastq file3.fastq\nMutually exclusive with --bamfile or --cramfile.")), ToolInput(tag="in_adapter", input_type=Boolean(optional=True), prefix="--adapter", doc=InputDocumentation(doc="[string] : sequence of 3' adapter to trim off during read-pre processing. Must be at least\n8 bases, with only ATCG characters. If not specified, reads are assumed to be already trimmed.")), ToolInput(tag="in_bowtie_cores", input_type=Boolean(optional=True), prefix="--bowtie_cores", doc=InputDocumentation(doc="[integer] : Argument to be passed to bowtie's -p option, specifying number of processor\ncores to request during alignment. Defaults to 1. Must be an integer of 1 or more.")), ToolInput(tag="in_sort_mem", input_type=Boolean(optional=True), prefix="--sort_mem", doc=InputDocumentation(doc="[string] : Argument to be passed to samtools sort -m option, which sets the maximum memory\nusage during bam file sorting. If not set, samtools sort defaults it to 768M. Higher settings will\nreduce the overall time spent in alignment phase, at cost of more memory usage. Use K/M/G suffixes to\nspecify kilobytes, megabytes, and gigabytes, respectively. Extremely large alignment jobs will\ncrash (due to crash of samtools sort operation) if --sort_mem is not set high enough. However, alignment\njobs will also crash if sort_mem is set too high, and all physical memory on your machine is exahusted.")), ToolInput(tag="in_mismatches", input_type=Boolean(optional=True), prefix="--mismatches", doc=InputDocumentation(doc="[integer] : Argument to be passed to bowtie's -v option, specifying number of mismatches\nto be tolerated in a valid alignment. Must be either 0, 1, or 2. In cases of multiple hits, only hits\nwith lowest number of mismatches kept. Default: 1.")), ToolInput(tag="in_c_quals", input_type=Boolean(optional=True), prefix="--cquals", doc=InputDocumentation(doc="[string] : path(s) to color-space quality value file(s). Used only in conjunction with .csfasta\nor .csfasta.gz formatted files in --readfile. Compressed format for cquals is NOT allowed. Like --readfile,\ncquals can take multiple arguments for multiple files, e.g. --cquals file1.qual file2.qual file3.qual")), ToolInput(tag="in_cram", input_type=Boolean(optional=True), prefix="--cram", doc=InputDocumentation(doc=": When aligning, convert final alignment to cram format instead of the default bam format.")), ToolInput(tag="in_mmap", input_type=Boolean(optional=True), prefix="--mmap", doc=InputDocumentation(doc="[string] : Protocol for handling multi-mapped reads. Valid entries are n (none), r (random), u (unique-\nseeded guide), or f (fractional-seeded guide). default: u")), ToolInput(tag="in_bowtie_m", input_type=Boolean(optional=True), prefix="--bowtie_m", doc=InputDocumentation(doc="[string] : Setting to be passed to the -m option of bowtie. Over-ridden and set to 1 if option\nmmap is set to n. This sets the maximum number of multi-mappings allowed. Valid settings are integers >= 1 OR set 'all'\nto disable suppression of highly multi-mapped reads. Default: 50")), ToolInput(tag="in_ran_max", input_type=Boolean(optional=True), prefix="--ranmax", doc=InputDocumentation(doc="[string] : Reads with more than this number of possible alignment positions where the\nchoice can't be guided by unequal  will be reported as unmapped. Irrelevant if option mmap is set\nto n or r. Must be integer of 2 or greater or set to 'none' to disable. Default: 3.")), ToolInput(tag="in_align_only", input_type=Boolean(optional=True), prefix="--align_only", doc=InputDocumentation(doc=": If this switch is present, the ShortStack run will terminate after the alignment phase\nwith no analysis performed.")), ToolInput(tag="in_show_secondaries", input_type=Boolean(optional=True), prefix="--show_secondaries", doc=InputDocumentation(doc=": If this switch is present, the output alignment file will contain secondary alignments\nas well as primary alignments for multi-mapped reads. Secondary alignments have bit 256 set in the SAM FLAG field.\nThis option can increase alignment file size, sometimes by a lot.")), ToolInput(tag="in_keep_quals", input_type=Boolean(optional=True), prefix="--keep_quals", doc=InputDocumentation(doc=": As of version 3.5, by default ShortStack alignments no longer store the quality values, to save space. Use\nof this switch will cause quality values to be retained. Note that this increases file size.")), ToolInput(tag="in_bam_file", input_type=Boolean(optional=True), prefix="--bamfile", doc=InputDocumentation(doc="[string] : path to input .bam alignment file of small RNAs. Only lines with bits 4 and 256\nunset will be used. Mutually exclusive with --readfile or --cramfile.")), ToolInput(tag="in_cram_file", input_type=Boolean(optional=True), prefix="--cramfile", doc=InputDocumentation(doc="[string] : path to input .cram alignment file of small RNAs. Only lines with bits 4 and 256\nunset will be used. Mutually exclusive with --readfile or --bamfile.")), ToolInput(tag="in_dicer_min", input_type=Boolean(optional=True), prefix="--dicermin", doc=InputDocumentation(doc="[integer] : Minimum size of a Dicer-processed small RNA. Must be an integer of at least 15\nand <= dicermax. Default: 20.")), ToolInput(tag="in_dicer_max", input_type=Boolean(optional=True), prefix="--dicermax", doc=InputDocumentation(doc="[integer] : Maximum size of a Dicer-processed small RNA. Must be an integer of at least 15\nand >= dicermin. Deafult: 24.")), ToolInput(tag="in_fold_size", input_type=Boolean(optional=True), prefix="--foldsize", doc=InputDocumentation(doc="[integer] : Size of genomic RNA segments for folding during MIRNA search. Any loci larger\nthan this size will not be analyzed with respect for MIRNA features. Must be an integer of at\nleast 200 and no larger than 1,000. Default: 300. Note that increasing this setting may drastically\nincrease runtimes.")), ToolInput(tag="in_loci_file", input_type=Boolean(optional=True), prefix="--locifile", doc=InputDocumentation(doc="[string] : Path to a tab-delimited plain-text file listing intervals to analyze. Lines\nstarting with # are ignored. First column is coordinate in format Chr:start-stop, second column\nis names (optional), and any other columns are ignored. Mutually exclusive with option --locus.")), ToolInput(tag="in_locus", input_type=Boolean(optional=True), prefix="--locus", doc=InputDocumentation(doc="[string] : Analyze the specified interval(s). Interval(s) is specified in format Chr:start-stop.\nMultiple intervals can be specified in a comma-separated list. Mutually exclusive with option\n--locifile. Specify the value for --total_primaries to make a single locus run fast.")), ToolInput(tag="in_no_hp", input_type=Boolean(optional=True), prefix="--nohp", doc=InputDocumentation(doc=": Disable MIRNA search.")), ToolInput(tag="in_pad", input_type=Boolean(optional=True), prefix="--pad", doc=InputDocumentation(doc="[integer] : Initially found clusters of small RNAs will be merged if the distance between them is\nless than or equal to the value of pad. Must be an integer between 0 and 50000. Default: 75.")), ToolInput(tag="in_min_cov", input_type=Boolean(optional=True), prefix="--mincov", doc=InputDocumentation(doc="[string] : Clusters of small RNAs must have at least this many alignments. Supply an\ninteger between 1 and 50000. Can also be a normalized value in reads per million (rpm) OR reads per million mapped (rpmm). When specifying mincov in\nrpm or rpmm, the mincov value must be a floating point number > 0 and < 500,000 followed\nby the string 'rpm' or 'rpmm'. Examples: '5' --> threshold is 5 raw reads. '3.2rpm' --> threshold is\n3.2 reads per million mapped. '2.8rpmm' --> threshold is 2.8 reads per million mapped. Deafult: 0.5rpm.")), ToolInput(tag="in_strand_cut_off", input_type=Boolean(optional=True), prefix="--strand_cutoff", doc=InputDocumentation(doc="[float] : Cutoff for calling the strandedness of a locus. Must be a floating point number\nbetween 0.5 and 1 (inclusive). DEFAULT: 0.8. At default of 0.8, a locus must have 80% of more of its\nreads on the top strand to be called a + strand locus, or 20% or less on the top strand to be a -\nstrand locus. All others receive no strand call (e.g. '.'). Only stranded loci are analyzed for\nMIRNAs, while only unstranded loci are analyzed with respect to phasing. Most users probably want\nto use the default setting of 0.8.")), ToolInput(tag="in_total_primaries", input_type=Boolean(optional=True), prefix="--total_primaries", doc=InputDocumentation(doc="[integer] : Tell ShortStack the total number of primary alignments in the bam file. Specifying\nthis value here speeds the analysis, since ShortStack does not need to count the reads directly from the bam file.\nCan only be specified in conjunction with --bamfile. This count should include all primary alignment INCLUDING unplaced ones."))], outputs=[ToolOutput(tag="out_outdir", output_type=Directory(optional=True), selector=InputSelector(input_to_select="in_outdir", type_hint=File()), doc=OutputDocumentation(doc="[string] : name of output directory to be created for results. Defaults to 'ShortStack_[time]',\nwhere [time] is the current UNIX time according to the system. If the outdir already exists, ShortStack\nwill exit with an error message."))], container=None, version="v0.1.0")


if __name__ == "__main__":
    # or "cwl"
    Shortstack_V0_1_0().translate("wdl", allow_empty_container=True)

