!Command
command:
- iCount
- xlsites
positional:
- !Positional
  optional: false
  position: 0
  name: bam
  description: Input BAM file with mapped reads
- !Positional
  optional: false
  position: 1
  name: sites_unique
  description: Output BED6 file to store data from uniquely mapped reads
- !Positional
  optional: false
  position: 2
  name: sites_multi
  description: Output BED6 file to store data from multi-mapped reads
- !Positional
  optional: false
  position: 3
  name: skipped
  description: "Output BAM file to store reads that do not map as expected by segmentation\
    \ and\nreference genome sequence. If read's second start does not fall on any\
    \ of\nsegmentation borders, it is considered problematic. If segmentation is not\
    \ provided,\nevery read in two parts with gap longer than gap_th is not used (skipped).\n\
    All such reads are reported to the user for further exploration"
named:
- !Flag
  optional: true
  synonyms:
  - -g
  - --group_by
  description: "Assign score of a read to either 'start', 'middle' or 'end' nucleotide\
    \ (default: start)"
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - --quant
  description: "Report number of 'cDNA' or number of 'reads' (default: cDNA)"
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - --segmentation
  description: 'File with custon segmentation format (obtained by ``iCount segment``)
    (default: None)'
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -mis
  - --mismatches
  description: "Reads on same position with random barcode differing less than\n``mismatches``\
    \ are grouped together (default: 2)"
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - --mapq_th
  description: 'Ignore hits with MAPQ < mapq_th (default: 0)'
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - --multimax
  description: 'Ignore reads, mapped to more than ``multimax`` places (default: 50)'
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - --gap_th
  description: 'Reads with gaps less than gap_th are treated as if they have no gap
    (default: 4)'
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -prog
  - --report_progress
  description: 'Switch to report progress (default: False)'
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -S
  - --stdout_log
  description: Threshold value (0-50) for logging to stdout. If 0, logging to stdout
    if turned OFF.
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -F
  - --file_log
  description: Threshold value (0-50) for logging to file. If 0, logging to file if
    turned OFF.
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -P
  - --file_logpath
  description: Path to log file.
  args: !EmptyFlagArg {}
- !Flag
  optional: true
  synonyms:
  - -M
  - --results_file
  description: File into which to store Metrics.
  args: !EmptyFlagArg {}
parent:
subcommands: []
usage: []
help_flag: !Flag
  optional: true
  synonyms:
  - -h
  - --help
  description: show this help message and exit
  args: !EmptyFlagArg {}
usage_flag:
version_flag:
help_text: "usage: iCount xlsites [-h] [-g] [--quant] [--segmentation] [-mis] [--mapq_th]\n\
  \                      [--multimax] [--gap_th] [-prog] [-S] [-F] [-P] [-M]\n   \
  \                   bam sites_unique sites_multi skipped\n\nQuantity cross-link\
  \ events and determine their positions.\n\nThe simplest version of this script would\
  \ oprate on such example::\n\n    |--a---b--- reference sequence, chr 14, positive\
  \ strand ------------\n        |rbc1---R1--------|\n        |rbc1---R2------|\n\
  \        |rbc2---R3------|\n            |rbc1--------R4-------------|\n        \
  \    |rbc3------R5-----|\n\nFive reads (R1-R5) are mapped to a reference sequence\
  \ (chromosome 14, positive\nstrand). Reads start on two distinct positons. On first\
  \ position, there is\nR1-R3. Cross-link site is located one nucleotide before start\
  \ of the read (on\nnegative strand, one nucleotide after end of read). However,\
  \ we wish to count\nnumber of cDNA molecules, not the number of reads. This can\
  \ be done by counting\nthe number of distinct random barcodes (sometimes also called\
  \ randomers). So in\nupper example, we have:\n\n    Postion a: 3 reads, 2 distinct\
  \ random barcodes = 2 cDNA's\n    Postion b: 2 reads, 2 distinct random barcodes\
  \ = 2 cDNA's\n\nHowever, things can get complicated when a single read is mapped\
  \ in multiple\nparts. This can happen for several reasons. One common example is\
  \ that introns\nare removed during transcription. This can be illustrated with the\
  \ following\nimage::\n\n    |---------------- reference -----------------------\n\
  \n    |--------------------------transcript--------------------------|\n    |---UTR5---||---intron---||---exon---||---intron---||---exon---|\n\
  \n                                |-------R1-------|\n                         \
  \       |--R2.1-->              <-R2.2-|\n                      |-R3.1->      <-R3.2->\
  \            <-R3.3-|\n                        |-R4.1->      <-R4.2-|\n\nRead R1\
  \ and R2 are starting on same position. For the sake of argument, let's\nalso pretend\
  \ they also have same random barcode. In so, we would count them as a\nsingle cDNA\
  \ molecule (= single cross-link event), even though it is obvious that\nthey represent\
  \ two separate cross-link events. In order to fix this, we count\nnot just the number\
  \ of different randomers on same position, but also number of\ndifferent \"second-start\"\
  \ coordinates. Second-start coordinate is just the\ncoordinate of the second part\
  \ of the read. This way, the actual number of\ncross-link events can be determined\
  \ more accurately. If read is not split, it's\nsecond-start coordinate is 0. If\
  \ read has multiple \"holes\" (as read R3) we\ndetermine second-start from the largest\
  \ hole.\n\nReads whose second-start do NOT fall on segmentation (like R4) are stored\
  \ in a\nseparate BAM file ``sites_strange``. They should be treated with special\
  \ care,\nsince they can indicate not-yet annotated features in genome. If segmentation\
  \ is\nnot given, all reads with holes, bigger than ``holesize_th`` are considered\n\
  strange.\n\nAnother parameter needs more explanation: ``group_by``. When algorithm\
  \ starts,\nreads from BAM file are grouped in hierarchical structure by::\n\n  \
  \  * chromosome and strand\n    * cross-link position\n    * random barcode\n  \
  \  * second-start\n\nEach second-start group receives 1 cDNA score. This score is\
  \ divided to each\nread in group (if there are 5 reads in group, each one gets 1/5\
  \ score). This\nenables that each read has it's cDNA score and of course, 1 \"read\
  \ score\". This\nscores can be assigned to start (actually, to cross-link position),\
  \ midlle or\nend position of read. By default, score is of course assigned to cross-link\n\
  location. But for diagnostic purpuses, scores can also be assigned to middle or\n\
  end coordinate of the read.\n\nTODO: check overlap between unique and multimap BED\
  \ files, should be small,\notherwise, we should think of a more approapriate quantification\
  \ of (division\nof randomers among) unique mapped sites that overlap with multimapped\
  \ reads\n\npositional arguments:\n  bam                   Input BAM file with mapped\
  \ reads\n  sites_unique          Output BED6 file to store data from uniquely mapped\
  \ reads\n  sites_multi           Output BED6 file to store data from multi-mapped\
  \ reads\n  skipped               Output BAM file to store reads that do not map\
  \ as expected by segmentation and\n                        reference genome sequence.\
  \ If read's second start does not fall on any of\n                        segmentation\
  \ borders, it is considered problematic. If segmentation is not provided,\n    \
  \                    every read in two parts with gap longer than gap_th is not\
  \ used (skipped).\n                        All such reads are reported to the user\
  \ for further exploration\n\noptional arguments:\n  -h, --help            show this\
  \ help message and exit\n  -g , --group_by       Assign score of a read to either\
  \ 'start', 'middle' or 'end' nucleotide (default: start)\n  --quant            \
  \   Report number of 'cDNA' or number of 'reads' (default: cDNA)\n  --segmentation\
  \        File with custon segmentation format (obtained by ``iCount segment``) (default:\
  \ None)\n  -mis , --mismatches   Reads on same position with random barcode differing\
  \ less than\n                        ``mismatches`` are grouped together (default:\
  \ 2)\n  --mapq_th             Ignore hits with MAPQ < mapq_th (default: 0)\n  --multimax\
  \            Ignore reads, mapped to more than ``multimax`` places (default: 50)\n\
  \  --gap_th              Reads with gaps less than gap_th are treated as if they\
  \ have no gap (default: 4)\n  -prog, --report_progress\n                       \
  \ Switch to report progress (default: False)\n  -S , --stdout_log     Threshold\
  \ value (0-50) for logging to stdout. If 0, logging to stdout if turned OFF.\n \
  \ -F , --file_log       Threshold value (0-50) for logging to file. If 0, logging\
  \ to file if turned OFF.\n  -P , --file_logpath   Path to log file.\n  -M , --results_file\
  \   File into which to store Metrics.\n"
generated_using:
- --help
docker_image:
