version 1.0

task RsemControlFdr {
  input {
    Boolean? hard_threshold
    Boolean? soft_threshold
    Boolean? h_slash_help
    String input_file
    String fdr_rate
    String output_file
  }
  command <<<
    rsem-control-fdr \
      ~{input_file} \
      ~{fdr_rate} \
      ~{output_file} \
      ~{true="--hard-threshold" false="" hard_threshold} \
      ~{true="--soft-threshold" false="" soft_threshold} \
      ~{true="-h/--help" false="" h_slash_help}
  >>>
  parameter_meta {
    hard_threshold: "Use hard threshold method to control FDR. If this option is set, only those genes/transcripts with their PPDE >= 1 - fdr_rate are called as DE. (Default: on)"
    soft_threshold: "Use soft threshold method to control FDR. If this option is set, this program will try to report as many genes/transcripts as possible, as long as their average PPDE >= 1 - fdr_rate. This option is equivalent to use EBSeq's 'crit_fun' for FDR control. (Default: off)"
    h_slash_help: "Show help information."
    input_file: "This should be the main result file generated by 'rsem-run-ebseq', which contains all genes/transcripts and their associated statistics."
    fdr_rate: "The desire false discovery rate (FDR)."
    output_file: "This file is a subset of the 'input_file'. It only contains the genes/transcripts called as differentially expressed (DE). When more than 2 conditions exist, DE is defined as not all conditions are equally expressed. Because statistical significance does not necessarily mean biological significance, users should also refer to the fold changes to decide which genes/transcripts are biologically significant. When more than two conditions exist, this file will not contain fold change information and users need to calculate it from 'input_file.condmeans' by themselves."
  }
}