version 1.0

task LAI {
  input {
    Boolean? genome
    Boolean? intact
    Boolean? all
    Boolean? window
    Boolean? step
    Boolean? quick_estimation_faster
    Boolean? qq
    Boolean? mono
    Boolean? iden
    Boolean? to_tltr
    Boolean? blast
    Boolean? number_run_blastn
  }
  command <<<
    LAI \
      ~{true="-genome" false="" genome} \
      ~{true="-intact" false="" intact} \
      ~{true="-all" false="" all} \
      ~{true="-window" false="" window} \
      ~{true="-step" false="" step} \
      ~{true="-q" false="" quick_estimation_faster} \
      ~{true="-qq" false="" qq} \
      ~{true="-mono" false="" mono} \
      ~{true="-iden" false="" iden} \
      ~{true="-totLTR" false="" to_tltr} \
      ~{true="-blast" false="" blast} \
      ~{true="-t" false="" number_run_blastn}
  >>>
  parameter_meta {
    genome: "[file]  The genome file that is used to generate everything."
    intact: "[file]  A list of intact LTR-RTs generated by LTR_retriever (genome.fa.pass.list)."
    all: "[file]     RepeatMasker annotation of all LTR sequences in the genome (genome.fa.out)."
    window: "[int]   Window size for LAI estimation. Default: 3000000 (3 Mb)"
    step: "[int]     Step size for the estimation window to move forward. Default: 300000 (300 Kb) Set step size = window size if prefer non-overlapping outputs."
    quick_estimation_faster: "Quick estimation of LTR identity (much faster for large genomes, may sacrifice ~0.5% of accuracy)."
    qq: "No estimation of LTR identity, only output raw LAI for within species comparison (very quick)."
    mono: "[file]    This parameter is mainly for ployploid genomes. User provides a list of sequence names that represent a monoploid (1x). LAI will calculated only on these sequences if provided. So user can also specify sequence of interest for LAI calculation."
    iden: "[0-100]   Mean LTR identity (%) in the monoploid (1x) genome. This parameter will inactivate de novo estimation (same speed to -qq)."
    to_tltr: "[0-100] Specify the total LTR sequence content (%) in the genome instead of estimating from the -all RepeatMasker file."
    blast: "[path]   The path to the blastn program. If left unspecified, then blastn must be accessible via shell ENV."
    number_run_blastn: "[number]     Number of threads to run blastn."
  }
}