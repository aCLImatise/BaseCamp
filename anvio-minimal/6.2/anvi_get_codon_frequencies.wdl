version 1.0

task AnviGetCodonFrequencies {
  input {
    String? contigs_db
    String? gene_caller_id
    Boolean? return_aa_frequencies_instead
    File? output_file
    Boolean? percent_normalize
    Boolean? mere_ns_codon_normalization
  }
  command <<<
    anvi-get-codon-frequencies \
      ~{if defined(contigs_db) then ("--contigs-db " +  '"' + contigs_db + '"') else ""} \
      ~{if defined(gene_caller_id) then ("--gene-caller-id " +  '"' + gene_caller_id + '"') else ""} \
      ~{true="--return-AA-frequencies-instead" false="" return_aa_frequencies_instead} \
      ~{if defined(output_file) then ("--output-file " +  '"' + output_file + '"') else ""} \
      ~{true="--percent-normalize" false="" percent_normalize} \
      ~{true="--merens-codon-normalization" false="" mere_ns_codon_normalization}
  >>>
  parameter_meta {
    contigs_db: "Anvi'o contigs database generated by 'anvi-gen- contigs'"
    gene_caller_id: "OK. You can declare a single gene caller ID if you wish, in which case anvi'o would only return results for a single gene call. If you don't declare anything, well, you must be prepared to brace yourself if you are working with a very large contigs database with hundreds of thousands of genes."
    return_aa_frequencies_instead: "By default, anvi'o will return codon frequencies (as the name suggests), but you can ask for amino acid frequencies instead, simply because you always need more data and more stuff. You're lucky this time, but is there an end to this? Will you ever be satisfied with what you have? Anvi'o needs answers."
    output_file: "File path to store results."
    percent_normalize: "Instead of actual counts, report percent-normalized frequencies per gene (because you are too lazy to do things the proper way in R)."
    mere_ns_codon_normalization: "This is a flag to percent normalize codon frequenies within those that encode for the same amino acid. It is different from the flag --percent-normalize, since it does not percent normalize frequencies of codons within a gene based on all codon frequencies. Clearly this flag is not applicable if you wish to work with boring amino acids. WHO WORKS WITH AMINO ACIDS ANYWAYS."
  }
}