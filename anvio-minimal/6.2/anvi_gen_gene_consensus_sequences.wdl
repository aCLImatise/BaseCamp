version 1.0

task AnviGenGeneConsensusSequences {
  input {
    Boolean? compress_samples
    String? profile_db
    String? contigs_db
    String? gene_caller_ids
    File? genes_of_interest
    File? samples_of_interest
    File? output_file
    Boolean? tab_delimited
    String? engine
    Boolean? contigs_mode
  }
  command <<<
    anvi-gen-gene-consensus-sequences \
      ~{true="--compress-samples" false="" compress_samples} \
      ~{if defined(profile_db) then ("--profile-db " +  '"' + profile_db + '"') else ""} \
      ~{if defined(contigs_db) then ("--contigs-db " +  '"' + contigs_db + '"') else ""} \
      ~{if defined(gene_caller_ids) then ("--gene-caller-ids " +  '"' + gene_caller_ids + '"') else ""} \
      ~{if defined(genes_of_interest) then ("--genes-of-interest " +  '"' + genes_of_interest + '"') else ""} \
      ~{if defined(samples_of_interest) then ("--samples-of-interest " +  '"' + samples_of_interest + '"') else ""} \
      ~{if defined(output_file) then ("--output-file " +  '"' + output_file + '"') else ""} \
      ~{true="--tab-delimited" false="" tab_delimited} \
      ~{if defined(engine) then ("--engine " +  '"' + engine + '"') else ""} \
      ~{true="--contigs-mode" false="" contigs_mode}
  >>>
  parameter_meta {
    compress_samples: "Normally all samples with variation will have their own consensus sequence. If this flag is provided, the coverages from each sample of interest will be summed and only a single consenus sequence for each gene/contig will be output."
    profile_db: "Anvi'o profile database"
    contigs_db: "Anvi'o contigs database generated by 'anvi-gen- contigs'"
    gene_caller_ids: "Gene caller ids. Multiple of them can be declared separated by a delimiter (the default is a comma). In anvi-gen-variability-profile, if you declare nothing you will get all genes matching your other filtering criteria. In other programs, you may get everything, nothing, or an error. It really depends on the situation. Fortunately, mistakes are cheap, so it's worth a try."
    genes_of_interest: "A file with anvi'o gene caller IDs. There should be only one column in the file, and each line should correspond to a unique gene caller id (without a column header)."
    samples_of_interest: "A file with samples names. There should be only one column in the file, and each line should correspond to a unique sample name (without a column header)."
    output_file: "The output file name. The boring default is \"genes.fa\". You can change the output file format to a TAB-delimited file using teh flag `--tab-delimited`, in which case please do not forget to change the file name, too."
    tab_delimited: "Use the TAB-delimited format for the output file."
    engine: "Variability engine. The default is 'NT'."
    contigs_mode: "Use this flag to output consensus sequences of contigs, instead of the default, which is genes"
  }
}