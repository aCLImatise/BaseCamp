version 1.0

task PlotCorrelation {
  input {
    File? cordata
    String? cor_method
    String? what_to_plot
    File? plot_file
    Boolean? skip_zeros
    String? labels
    String? plot_title
    File? plot_file_format
    Boolean? remove_outliers
    File? outfile_cor_matrix
    String? plot_height
    String? plot_width
    String? zmin
    String? zmax
    Boolean? colormap
    Boolean? plot_numbers
    String? x_range
    String? y_range
    Boolean? logo_nep
  }
  command <<<
    plotCorrelation \
      ~{if defined(cordata) then ("--corData " +  '"' + cordata + '"') else ""} \
      ~{if defined(cor_method) then ("--corMethod " +  '"' + cor_method + '"') else ""} \
      ~{if defined(what_to_plot) then ("--whatToPlot " +  '"' + what_to_plot + '"') else ""} \
      ~{if defined(plot_file) then ("--plotFile " +  '"' + plot_file + '"') else ""} \
      ~{true="--skipZeros" false="" skip_zeros} \
      ~{if defined(labels) then ("--labels " +  '"' + labels + '"') else ""} \
      ~{if defined(plot_title) then ("--plotTitle " +  '"' + plot_title + '"') else ""} \
      ~{if defined(plot_file_format) then ("--plotFileFormat " +  '"' + plot_file_format + '"') else ""} \
      ~{true="--removeOutliers" false="" remove_outliers} \
      ~{if defined(outfile_cor_matrix) then ("--outFileCorMatrix " +  '"' + outfile_cor_matrix + '"') else ""} \
      ~{if defined(plot_height) then ("--plotHeight " +  '"' + plot_height + '"') else ""} \
      ~{if defined(plot_width) then ("--plotWidth " +  '"' + plot_width + '"') else ""} \
      ~{if defined(zmin) then ("--zMin " +  '"' + zmin + '"') else ""} \
      ~{if defined(zmax) then ("--zMax " +  '"' + zmax + '"') else ""} \
      ~{true="--colorMap" false="" colormap} \
      ~{true="--plotNumbers" false="" plot_numbers} \
      ~{if defined(x_range) then ("--xRange " +  '"' + x_range + '"') else ""} \
      ~{if defined(y_range) then ("--yRange " +  '"' + y_range + '"') else ""} \
      ~{true="--log1p" false="" logo_nep}
  >>>
  parameter_meta {
    cordata: "Compressed matrix of values generated by multiBigwigSummary or multiBamSummary"
    cor_method: "Correlation method."
    what_to_plot: "Choose between a heatmap or pairwise scatter plots"
    plot_file: "File to save the heatmap to. The file extension determines the format, so heatmap.pdf will save the heatmap in PDF format. The available formats are: .png, .eps, .pdf and .svg."
    skip_zeros: "By setting this option, genomic regions that have zero or missing (nan) values in all samples are excluded."
    labels: "sample2 [sample1 sample2 ...], -l sample1 sample2 [sample1 sample2 ...] User defined labels instead of default labels from file names. Multiple labels have to be separated by spaces, e.g. --labels sample1 sample2 sample3"
    plot_title: "Title of the plot, to be printed on top of the generated image. Leave blank for no title. (Default: )"
    plot_file_format: "Image format type. If given, this option overrides the image format based on the plotFile ending. The available options are: png, eps, pdf and svg."
    remove_outliers: "If set, bins with very large counts are removed. Bins with abnormally high reads counts artificially increase pearson correlation; that's why, multiBamSummary tries to remove outliers using the median absolute deviation (MAD) method applying a threshold of 200 to only consider extremely large deviations from the median. The ENCODE blacklist page  (https://sites.google.com/site/anshulkundaje/projects/ blacklists) contains useful information about regions with unusually high countsthat may be worth removing."
    outfile_cor_matrix: "Save matrix with pairwise correlation values to a tab- separated file."
    plot_height: "Plot height in cm. (Default: 9.5)"
    plot_width: "Plot width in cm. The minimum value is 1 cm. (Default: 11)"
    zmin: "Minimum value for the heatmap intensities. If not specified, the value is set automatically"
    zmax: "Maximum value for the heatmap intensities.If not specified, the value is set automatically"
    colormap: "Color map to use for the heatmap. Available values can be seen here: http://matplotlib.org/examples/color/col ormaps_reference.html"
    plot_numbers: "If set, then the correlation number is plotted on top of the heatmap. This option is only valid when plotting a heatmap."
    x_range: "XRANGE The X axis range. The default scales these such that the full range of dots is displayed."
    y_range: "YRANGE The Y axis range. The default scales these such that the full range of dots is displayed."
    logo_nep: "Plot the natural log of the scatter plot after adding 1. Note that this is ONLY for plotting, the correlation is unaffected."
  }
}