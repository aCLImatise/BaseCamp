version 1.0

task LiBis {
  input {
    File? file
    File? setting_file
    Boolean? required_fastq_file
    Int? clip
    Boolean? required_labels_samples
    Int? genome
    Int? window
    Int? step
    Int? process
    File? ref
    Int? quality_control
    Int? trim
    Int? binsize
    Int? filter
    File? bam
    Boolean? m_call
    Boolean? plot
    Boolean? no_check
    Boolean? multiple_mapping
    Boolean? pair_end_filter
    Boolean? full_mode
    String? name
  }
  command <<<
    LiBis \
      ~{name} \
      ~{if defined(file) then ("--file " +  '"' + file + '"') else ""} \
      ~{if defined(setting_file) then ("--settingfile " +  '"' + setting_file + '"') else ""} \
      ~{if (required_fastq_file) then "-n" else ""} \
      ~{if defined(clip) then ("--clip " +  '"' + clip + '"') else ""} \
      ~{if (required_labels_samples) then "-l" else ""} \
      ~{if defined(genome) then ("--genome " +  '"' + genome + '"') else ""} \
      ~{if defined(window) then ("--window " +  '"' + window + '"') else ""} \
      ~{if defined(step) then ("--step " +  '"' + step + '"') else ""} \
      ~{if defined(process) then ("--process " +  '"' + process + '"') else ""} \
      ~{if defined(ref) then ("--ref " +  '"' + ref + '"') else ""} \
      ~{if defined(quality_control) then ("--QualityControl " +  '"' + quality_control + '"') else ""} \
      ~{if defined(trim) then ("--trim " +  '"' + trim + '"') else ""} \
      ~{if defined(binsize) then ("--binsize " +  '"' + binsize + '"') else ""} \
      ~{if defined(filter) then ("--filter " +  '"' + filter + '"') else ""} \
      ~{if defined(bam) then ("--bam " +  '"' + bam + '"') else ""} \
      ~{if (m_call) then "--mcall" else ""} \
      ~{if (plot) then "--plot" else ""} \
      ~{if (no_check) then "--nocheck" else ""} \
      ~{if (multiple_mapping) then "--multiplemapping" else ""} \
      ~{if (pair_end_filter) then "--pairendfilter" else ""} \
      ~{if (full_mode) then "--fullmode" else ""}
  >>>
  parameter_meta {
    file: "Required. Enter a number, 0 means using parameter to\\nset up, 1 means using text file to set up"
    setting_file: "Required. Setting txt file name. Ignore if -f is 0."
    required_fastq_file: "[NAME [NAME ...]], --name [NAME [NAME ...]]\\nRequired. Fastq file name."
    clip: "Clip mode. 0 means close. 1 means open. default: 0"
    required_labels_samples: "[LABEL [LABEL ...]], --label [LABEL [LABEL ...]]\\nRequired. Labels for samples"
    genome: "Required. Genome the reference belong to.(Use for\\nplotting) hg18/hg19/mm10/mm9 and so on. Plotting\\nscript will not avaliable if leave it blank"
    window: "Window length for clipping mode, default=30"
    step: "Step size for clipping mode."
    process: "Threads number for BSMAP and Samtools."
    ref: "Required. Reference genome file name."
    quality_control: "Do(1) quality control or not(0)"
    trim: "Do(1) trimming or not(0)."
    binsize: "Plot setting. Set the bin size for averaging\\nmethylation ratio among samples, default=1000k"
    filter: "Minimal length for recombined reads"
    bam: "Processed bam file for the first step. If bam files\\nare offered here, the first step of bsmap will be\\nskipped. BAM files can only be generated by BSMAP.\\nDifferent files should be seperated by ','. If there's\\nno bam file for part of the samples, leave the space\\nblank. For example: a.bam,b.bam,,,,f.bam"
    m_call: "Run mcall for mapped bams or not"
    plot: "Generate the final report or not"
    no_check: "Skip the checking step for result folders. Using this\\nparameter may rewrite the previous results."
    multiple_mapping: "Apply multiple mapping after first around bsmap"
    pair_end_filter: "Apply pairend filter for all LiBis rescued reads. Only\\nkeep reads have uniquely mapped pair by BSMAP or\\nLiBis."
    full_mode: "Keep all temp files.\\n"
    name: ""
  }
  output {
    File out_stdout = stdout()
  }
}