version 1.0

task AnviSplit {
  input {
    String? pan_or_profile_db
    String? contigs_db
    String? genomes_storage
    Boolean? skip_variability_tables
    Boolean? compress_auxiliary_data
    String? collection_name
    String? bin_id
    String? output_dir
    Boolean? list_collections
    Boolean? skip_hierarchical_clustering
    Boolean? enforce_hierarchical_clustering
    String? distance
    String? linkage
  }
  command <<<
    anvi-split \
      ~{if defined(pan_or_profile_db) then ("--pan-or-profile-db " +  '"' + pan_or_profile_db + '"') else ""} \
      ~{if defined(contigs_db) then ("--contigs-db " +  '"' + contigs_db + '"') else ""} \
      ~{if defined(genomes_storage) then ("--genomes-storage " +  '"' + genomes_storage + '"') else ""} \
      ~{true="--skip-variability-tables" false="" skip_variability_tables} \
      ~{true="--compress-auxiliary-data" false="" compress_auxiliary_data} \
      ~{if defined(collection_name) then ("--collection-name " +  '"' + collection_name + '"') else ""} \
      ~{if defined(bin_id) then ("--bin-id " +  '"' + bin_id + '"') else ""} \
      ~{if defined(output_dir) then ("--output-dir " +  '"' + output_dir + '"') else ""} \
      ~{true="--list-collections" false="" list_collections} \
      ~{true="--skip-hierarchical-clustering" false="" skip_hierarchical_clustering} \
      ~{true="--enforce-hierarchical-clustering" false="" enforce_hierarchical_clustering} \
      ~{if defined(distance) then ("--distance " +  '"' + distance + '"') else ""} \
      ~{if defined(linkage) then ("--linkage " +  '"' + linkage + '"') else ""}
  >>>
  parameter_meta {
    pan_or_profile_db: "Anvi'o pan or profile database (and even genes database in appropriate contexts)."
    contigs_db: "Anvi'o contigs database generated by 'anvi-gen- contigs'"
    genomes_storage: "Anvi'o genomes storage file"
    skip_variability_tables: "Processing variability tables in profile database might take a very long time. With this flag you will be asking anvi'o to skip them."
    compress_auxiliary_data: "When declared, the auxiliary data file in the resulting output will be compressed. This saves space, but it takes long. Also, if you are planning to compress the entire later using GZIP, it is even useless to do. But you are the boss!"
    collection_name: "Collection name."
    bin_id: "Bin name you are interested in."
    output_dir: "Directory path for output files"
    list_collections: "Show available collections and exit."
    skip_hierarchical_clustering: "If you are not planning to use the interactive interface (or if you have other means to add a tree of contigs in the database) you may skip the step where hierarchical clustering of your items are preformed based on default clustering recipes matching to your database type."
    enforce_hierarchical_clustering: "If you have more than 25,000 splits in your merged profile, anvi-merge will automatically skip the hierarchical clustering of splits (by setting --skip- hierarchical-clustering flag on). This is due to the fact that computational time required for hierarchical clustering increases exponentially with the number of items being clustered. Based on our experience we decided that 25,000 splits is about the maximum we should try. However, this is not a theoretical limit, and you can overwrite this heuristic by using this flag, which would tell anvi'o to attempt to cluster splits regardless."
    distance: "The distance metric for the hierarchical clustering. If you do not use this flag, the default distance metric will be used for each clustering configuration which is \"euclidean\"."
    linkage: "The same story with the `--distance`, except, the system default for this one is ward."
  }
}