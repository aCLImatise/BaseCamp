version 1.0

task AnviRenameBins {
  input {
    String? contigs_db
    String? profile_db
    String? collection_to_read
    String? collection_to_write
    String? prefix
    String? report_file
    Boolean? list_collections
    Boolean? dry_run
    String? size_for_mag
  }
  command <<<
    anvi-rename-bins \
      ~{if defined(contigs_db) then ("--contigs-db " +  '"' + contigs_db + '"') else ""} \
      ~{if defined(profile_db) then ("--profile-db " +  '"' + profile_db + '"') else ""} \
      ~{if defined(collection_to_read) then ("--collection-to-read " +  '"' + collection_to_read + '"') else ""} \
      ~{if defined(collection_to_write) then ("--collection-to-write " +  '"' + collection_to_write + '"') else ""} \
      ~{if defined(prefix) then ("--prefix " +  '"' + prefix + '"') else ""} \
      ~{if defined(report_file) then ("--report-file " +  '"' + report_file + '"') else ""} \
      ~{true="--list-collections" false="" list_collections} \
      ~{true="--dry-run" false="" dry_run} \
      ~{if defined(size_for_mag) then ("--size-for-MAG " +  '"' + size_for_mag + '"') else ""}
  >>>
  parameter_meta {
    contigs_db: "Anvi'o contigs database generated by 'anvi-gen- contigs'"
    profile_db: "Anvi'o profile database"
    collection_to_read: "Collection name to read from. Anvi'o will not overwrite an existing collection, instead, it will create a copy of your collection with new bin names."
    collection_to_write: "The new collection name. Give it a nice, fancy name."
    prefix: "Prefix for the bin names. Must be a single word, composed of digits and numbers. The use of the underscore character is OK, but that's about it (fine, the use of the dash character is OK, too but no more!). If the prefix is 'PREFIX', each bin will be renamed as 'PREFIX_XXX_00001, PREFIX_XXX_00002', and so on, in the order of percent completion minus percent redundancy (what we call, 'substantive completion'). The 'XXX' part will either be 'Bin', or 'MAG depending on other parameters you use. Keep reading."
    report_file: "This file will report each name change event, so you can trace back the original names of renamed bins later."
    list_collections: "Show available collections and exit."
    dry_run: "When used does NOT update the profile database, just creates the report file so you can view how things will be renamed."
    size_for_mag: "If --call-MAGs flag is used, call any bin a 'MAG' if their redundancy estimate is less than --max- redundancy-for-MAG, AND THEIR SIZE IS LARGER THAN THIS VALUE REGARDLESS OF THE COMPLETION ESTIMATE. The default behavior is to not care about this at all."
  }
}