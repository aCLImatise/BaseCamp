version 1.0

task Anvirenamebins {
  input {
    String? contigs_db
    String? profile_db
    String? collection_to_read
    String? collection_to_write
    Int? prefix
    File? report_file
    Boolean? list_collections
    Boolean? dry_run
    Boolean? call_mags
    Boolean? min_completion_for_mag
    Boolean? max_redundancy_for_mag
    Int? size_for_mag
  }
  command <<<
    anvi_rename_bins \
      ~{if defined(contigs_db) then ("--contigs-db " +  '"' + contigs_db + '"') else ""} \
      ~{if defined(profile_db) then ("--profile-db " +  '"' + profile_db + '"') else ""} \
      ~{if defined(collection_to_read) then ("--collection-to-read " +  '"' + collection_to_read + '"') else ""} \
      ~{if defined(collection_to_write) then ("--collection-to-write " +  '"' + collection_to_write + '"') else ""} \
      ~{if defined(prefix) then ("--prefix " +  '"' + prefix + '"') else ""} \
      ~{if defined(report_file) then ("--report-file " +  '"' + report_file + '"') else ""} \
      ~{if (list_collections) then "--list-collections" else ""} \
      ~{if (dry_run) then "--dry-run" else ""} \
      ~{if (call_mags) then "--call-MAGs" else ""} \
      ~{if (min_completion_for_mag) then "--min-completion-for-MAG" else ""} \
      ~{if (max_redundancy_for_mag) then "--max-redundancy-for-MAG" else ""} \
      ~{if defined(size_for_mag) then ("--size-for-MAG " +  '"' + size_for_mag + '"') else ""}
  >>>
  runtime {
    docker: "None"
  }
  parameter_meta {
    contigs_db: "Anvi'o contigs database generated by 'anvi-gen-\\ncontigs'"
    profile_db: "Anvi'o profile database"
    collection_to_read: "Collection name to read from. Anvi'o will not\\noverwrite an existing collection, instead, it will\\ncreate a copy of your collection with new bin names."
    collection_to_write: "The new collection name. Give it a nice, fancy name."
    prefix: "Prefix for the bin names. Must be a single word,\\ncomposed of digits and numbers. The use of the\\nunderscore character is OK, but that's about it (fine,\\nthe use of the dash character is OK, too but no\\nmore!). If the prefix is 'PREFIX', each bin will be\\nrenamed as 'PREFIX_XXX_00001, PREFIX_XXX_00002', and\\nso on, in the order of percent completion minus\\npercent redundancy (what we call, 'substantive\\ncompletion'). The 'XXX' part will either be 'Bin', or\\n'MAG depending on other parameters you use. Keep\\nreading."
    report_file: "This file will report each name change event, so you\\ncan trace back the original names of renamed bins\\nlater."
    list_collections: "Show available collections and exit."
    dry_run: "When used does NOT update the profile database, just\\ncreates the report file so you can view how things\\nwill be renamed."
    call_mags: "This program by default rename your bins as\\n'PREFIX_Bin_00001', 'PREFIX_Bin_00002' and so on. If\\nyou use this flag, it will name the ones that meet the\\ncriteria described by MAG-related flags as\\n'PREFIX_MAG_00001', 'PREFIX_MAG_00002', and so on. The\\nones that do not get to be named as MAGs will remain\\nas bins."
    min_completion_for_mag: "[0-100]\\nIf --call-MAGs flag is used, call any bin a 'MAG' if\\ntheir completion estimate is above this (the default\\nis 70), and the redundancy estimate is less than\\n--max-redundancy-for-MAG."
    max_redundancy_for_mag: "[0-100]\\nIf --call-MAGs flag is used, call any bin a 'MAG' if\\ntheir redundancy estimate is below this (the default\\nis 10) and the completion estimate is above --min-\\ncompletion-for-MAG."
    size_for_mag: "If --call-MAGs flag is used, call any bin a 'MAG' if\\ntheir redundancy estimate is less than --max-\\nredundancy-for-MAG, AND THEIR SIZE IS LARGER THAN THIS\\nVALUE REGARDLESS OF THE COMPLETION ESTIMATE. The\\ndefault behavior is to not care about this at all.\\n"
  }
  output {
    File out_stdout = stdout()
  }
}